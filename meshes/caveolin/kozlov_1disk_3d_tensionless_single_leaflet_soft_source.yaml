global_parameters:
  # Benchmark (γ=0): single-leaflet soft (driving) rim source -> curvature -> opposite leaflet tilt.
  #
  # This uses a Kozlov-style driving term on the inner rim for the inner leaflet
  # only: E_source = -∮ γ_in (t_in · r_hat) dl.
  surface_tension: 0.0
  bending_energy_model: helfrich
  spontaneous_curvature: 0.0

  # Symmetric elastic constants (match `docs/tex/1_disk_3d.pdf` convention).
  bending_modulus_in: 2.0
  bending_modulus_out: 2.0
  tilt_modulus_in: 2.0
  tilt_modulus_out: 2.0

  tilt_rim_source_center: [0.0, 0.0, 0.0]
  tilt_rim_source_group_in: inner
  # Contact mapping (Kozlov/Barnoy): F_cont = -2π R h (Δε/a) θ_B.
  tilt_rim_source_contact_units: solver
  tilt_rim_source_contact_h_in: 1.0
  tilt_rim_source_contact_delta_epsilon_over_a_in: 40.0

  tilt_solve_mode: nested
  tilt_step_size: 0.15
  tilt_inner_steps: 40
  tilt_tol: 1e-10

  # Allow shape relaxation.
  step_size: 0.006
  step_size_mode: fixed

  pin_to_plane_normal: [0.0, 0.0, 1.0]
  pin_to_plane_point: [0.0, 0.0, 0.0]

constraint_modules:
  - pin_to_plane
  - pin_to_circle

definitions:
  inner_rim:
    constraints: ["pin_to_circle"]
    pin_to_circle_group: inner
    pin_to_circle_radius: 1.0
    pin_to_circle_normal: [0.0, 0.0, 1.0]
    pin_to_circle_point: [0.0, 0.0, 0.0]
    pin_to_circle_mode: fixed
  outer_rim:
    constraints: ["pin_to_circle", "pin_to_plane"]
    pin_to_circle_group: outer
    pin_to_circle_radius: 6.0
    pin_to_circle_normal: [0.0, 0.0, 1.0]
    pin_to_circle_point: [0.0, 0.0, 0.0]
    pin_to_circle_mode: fixed
    tilt_fixed_in: true
    tilt_fixed_out: true

energy_modules:
  - bending_tilt_in
  - bending_tilt_out
  - tilt_in
  - tilt_out
  - tilt_rim_source_in

vertices:
  # 7 concentric 12-gons (r=1..6) triangulated into an annulus (84 vertices).
  # Outer rim clamps both leaflets to zero tilt.
  # Ring r=1.83333333 has a tiny uniform +z offset to select an up/down branch
  # while preserving axisymmetry.
  - [1, 0.0, 0.0, {preset: inner_rim}]
  - [0.8660254, 0.5, 0.0, {preset: inner_rim}]
  - [0.5, 0.8660254, 0.0, {preset: inner_rim}]
  - [0.0, 1, 0.0, {preset: inner_rim}]
  - [-0.5, 0.8660254, 0.0, {preset: inner_rim}]
  - [-0.8660254, 0.5, 0.0, {preset: inner_rim}]
  - [-1, 0.0, 0.0, {preset: inner_rim}]
  - [-0.8660254, -0.5, 0.0, {preset: inner_rim}]
  - [-0.5, -0.8660254, 0.0, {preset: inner_rim}]
  - [0.0, -1, 0.0, {preset: inner_rim}]
  - [0.5, -0.8660254, 0.0, {preset: inner_rim}]
  - [0.8660254, -0.5, 0.0, {preset: inner_rim}]
  - [1.83333333, 0.0, 0.001]
  - [1.58771324, 0.91666667, 0.001]
  - [0.91666667, 1.58771324, 0.001]
  - [0.0, 1.83333333, 0.001]
  - [-0.91666667, 1.58771324, 0.001]
  - [-1.58771324, 0.91666667, 0.001]
  - [-1.83333333, 0.0, 0.001]
  - [-1.58771324, -0.91666667, 0.001]
  - [-0.91666667, -1.58771324, 0.001]
  - [0.0, -1.83333333, 0.001]
  - [0.91666667, -1.58771324, 0.001]
  - [1.58771324, -0.91666667, 0.001]
  - [2.66666667, 0.0, 0.0]
  - [2.30940108, 1.33333333, 0.0]
  - [1.33333333, 2.30940108, 0.0]
  - [0.0, 2.66666667, 0.0]
  - [-1.33333333, 2.30940108, 0.0]
  - [-2.30940108, 1.33333333, 0.0]
  - [-2.66666667, 0.0, 0.0]
  - [-2.30940108, -1.33333333, 0.0]
  - [-1.33333333, -2.30940108, 0.0]
  - [0.0, -2.66666667, 0.0]
  - [1.33333333, -2.30940108, 0.0]
  - [2.30940108, -1.33333333, 0.0]
  - [3.5, 0.0, 0.0]
  - [3.03108891, 1.75, 0.0]
  - [1.75, 3.03108891, 0.0]
  - [0.0, 3.5, 0.0]
  - [-1.75, 3.03108891, 0.0]
  - [-3.03108891, 1.75, 0.0]
  - [-3.5, 0.0, 0.0]
  - [-3.03108891, -1.75, 0.0]
  - [-1.75, -3.03108891, 0.0]
  - [0.0, -3.5, 0.0]
  - [1.75, -3.03108891, 0.0]
  - [3.03108891, -1.75, 0.0]
  - [4.33333333, 0.0, 0.0]
  - [3.75277675, 2.16666667, 0.0]
  - [2.16666667, 3.75277675, 0.0]
  - [0.0, 4.33333333, 0.0]
  - [-2.16666667, 3.75277675, 0.0]
  - [-3.75277675, 2.16666667, 0.0]
  - [-4.33333333, 0.0, 0.0]
  - [-3.75277675, -2.16666667, 0.0]
  - [-2.16666667, -3.75277675, 0.0]
  - [0.0, -4.33333333, 0.0]
  - [2.16666667, -3.75277675, 0.0]
  - [3.75277675, -2.16666667, 0.0]
  - [5.16666667, 0.0, 0.0]
  - [4.47446459, 2.58333333, 0.0]
  - [2.58333333, 4.47446459, 0.0]
  - [0.0, 5.16666667, 0.0]
  - [-2.58333333, 4.47446459, 0.0]
  - [-4.47446459, 2.58333333, 0.0]
  - [-5.16666667, 0.0, 0.0]
  - [-4.47446459, -2.58333333, 0.0]
  - [-2.58333333, -4.47446459, 0.0]
  - [0.0, -5.16666667, 0.0]
  - [2.58333333, -4.47446459, 0.0]
  - [4.47446459, -2.58333333, 0.0]
  - [6, 0.0, 0.0, {preset: outer_rim, tilt_in: [0.0, 0.0], tilt_out: [0.0, 0.0]}]
  - [5.19615242, 3, 0.0, {preset: outer_rim, tilt_in: [0.0, 0.0], tilt_out: [0.0, 0.0]}]
  - [3, 5.19615242, 0.0, {preset: outer_rim, tilt_in: [0.0, 0.0], tilt_out: [0.0, 0.0]}]
  - [0.0, 6, 0.0, {preset: outer_rim, tilt_in: [0.0, 0.0], tilt_out: [0.0, 0.0]}]
  - [-3, 5.19615242, 0.0, {preset: outer_rim, tilt_in: [0.0, 0.0], tilt_out: [0.0, 0.0]}]
  - [-5.19615242, 3, 0.0, {preset: outer_rim, tilt_in: [0.0, 0.0], tilt_out: [0.0, 0.0]}]
  - [-6, 0.0, 0.0, {preset: outer_rim, tilt_in: [0.0, 0.0], tilt_out: [0.0, 0.0]}]
  - [-5.19615242, -3, 0.0, {preset: outer_rim, tilt_in: [0.0, 0.0], tilt_out: [0.0, 0.0]}]
  - [-3, -5.19615242, 0.0, {preset: outer_rim, tilt_in: [0.0, 0.0], tilt_out: [0.0, 0.0]}]
  - [0.0, -6, 0.0, {preset: outer_rim, tilt_in: [0.0, 0.0], tilt_out: [0.0, 0.0]}]
  - [3, -5.19615242, 0.0, {preset: outer_rim, tilt_in: [0.0, 0.0], tilt_out: [0.0, 0.0]}]
  - [5.19615242, -3, 0.0, {preset: outer_rim, tilt_in: [0.0, 0.0], tilt_out: [0.0, 0.0]}]
edges:
  - [0, 1]
  - [1, 2]
  - [2, 3]
  - [3, 4]
  - [4, 5]
  - [5, 6]
  - [6, 7]
  - [7, 8]
  - [8, 9]
  - [9, 10]
  - [10, 11]
  - [11, 0]
  - [12, 13]
  - [13, 14]
  - [14, 15]
  - [15, 16]
  - [16, 17]
  - [17, 18]
  - [18, 19]
  - [19, 20]
  - [20, 21]
  - [21, 22]
  - [22, 23]
  - [23, 12]
  - [24, 25]
  - [25, 26]
  - [26, 27]
  - [27, 28]
  - [28, 29]
  - [29, 30]
  - [30, 31]
  - [31, 32]
  - [32, 33]
  - [33, 34]
  - [34, 35]
  - [35, 24]
  - [36, 37]
  - [37, 38]
  - [38, 39]
  - [39, 40]
  - [40, 41]
  - [41, 42]
  - [42, 43]
  - [43, 44]
  - [44, 45]
  - [45, 46]
  - [46, 47]
  - [47, 36]
  - [48, 49]
  - [49, 50]
  - [50, 51]
  - [51, 52]
  - [52, 53]
  - [53, 54]
  - [54, 55]
  - [55, 56]
  - [56, 57]
  - [57, 58]
  - [58, 59]
  - [59, 48]
  - [60, 61]
  - [61, 62]
  - [62, 63]
  - [63, 64]
  - [64, 65]
  - [65, 66]
  - [66, 67]
  - [67, 68]
  - [68, 69]
  - [69, 70]
  - [70, 71]
  - [71, 60]
  - [72, 73]
  - [73, 74]
  - [74, 75]
  - [75, 76]
  - [76, 77]
  - [77, 78]
  - [78, 79]
  - [79, 80]
  - [80, 81]
  - [81, 82]
  - [82, 83]
  - [83, 72]
  - [0, 12]
  - [1, 13]
  - [2, 14]
  - [3, 15]
  - [4, 16]
  - [5, 17]
  - [6, 18]
  - [7, 19]
  - [8, 20]
  - [9, 21]
  - [10, 22]
  - [11, 23]
  - [12, 24]
  - [13, 25]
  - [14, 26]
  - [15, 27]
  - [16, 28]
  - [17, 29]
  - [18, 30]
  - [19, 31]
  - [20, 32]
  - [21, 33]
  - [22, 34]
  - [23, 35]
  - [24, 36]
  - [25, 37]
  - [26, 38]
  - [27, 39]
  - [28, 40]
  - [29, 41]
  - [30, 42]
  - [31, 43]
  - [32, 44]
  - [33, 45]
  - [34, 46]
  - [35, 47]
  - [36, 48]
  - [37, 49]
  - [38, 50]
  - [39, 51]
  - [40, 52]
  - [41, 53]
  - [42, 54]
  - [43, 55]
  - [44, 56]
  - [45, 57]
  - [46, 58]
  - [47, 59]
  - [48, 60]
  - [49, 61]
  - [50, 62]
  - [51, 63]
  - [52, 64]
  - [53, 65]
  - [54, 66]
  - [55, 67]
  - [56, 68]
  - [57, 69]
  - [58, 70]
  - [59, 71]
  - [60, 72]
  - [61, 73]
  - [62, 74]
  - [63, 75]
  - [64, 76]
  - [65, 77]
  - [66, 78]
  - [67, 79]
  - [68, 80]
  - [69, 81]
  - [70, 82]
  - [71, 83]
  - [0, 13]
  - [1, 14]
  - [2, 15]
  - [3, 16]
  - [4, 17]
  - [5, 18]
  - [6, 19]
  - [7, 20]
  - [8, 21]
  - [9, 22]
  - [10, 23]
  - [11, 12]
  - [12, 25]
  - [13, 26]
  - [14, 27]
  - [15, 28]
  - [16, 29]
  - [17, 30]
  - [18, 31]
  - [19, 32]
  - [20, 33]
  - [21, 34]
  - [22, 35]
  - [23, 24]
  - [24, 37]
  - [25, 38]
  - [26, 39]
  - [27, 40]
  - [28, 41]
  - [29, 42]
  - [30, 43]
  - [31, 44]
  - [32, 45]
  - [33, 46]
  - [34, 47]
  - [35, 36]
  - [36, 49]
  - [37, 50]
  - [38, 51]
  - [39, 52]
  - [40, 53]
  - [41, 54]
  - [42, 55]
  - [43, 56]
  - [44, 57]
  - [45, 58]
  - [46, 59]
  - [47, 48]
  - [48, 61]
  - [49, 62]
  - [50, 63]
  - [51, 64]
  - [52, 65]
  - [53, 66]
  - [54, 67]
  - [55, 68]
  - [56, 69]
  - [57, 70]
  - [58, 71]
  - [59, 60]
  - [60, 73]
  - [61, 74]
  - [62, 75]
  - [63, 76]
  - [64, 77]
  - [65, 78]
  - [66, 79]
  - [67, 80]
  - [68, 81]
  - [69, 82]
  - [70, 83]
  - [71, 72]
faces:
  - [0, 85, r156]
  - [156, r12, r84]
  - [1, 86, r157]
  - [157, r13, r85]
  - [2, 87, r158]
  - [158, r14, r86]
  - [3, 88, r159]
  - [159, r15, r87]
  - [4, 89, r160]
  - [160, r16, r88]
  - [5, 90, r161]
  - [161, r17, r89]
  - [6, 91, r162]
  - [162, r18, r90]
  - [7, 92, r163]
  - [163, r19, r91]
  - [8, 93, r164]
  - [164, r20, r92]
  - [9, 94, r165]
  - [165, r21, r93]
  - [10, 95, r166]
  - [166, r22, r94]
  - [11, 84, r167]
  - [167, r23, r95]
  - [12, 97, r168]
  - [168, r24, r96]
  - [13, 98, r169]
  - [169, r25, r97]
  - [14, 99, r170]
  - [170, r26, r98]
  - [15, 100, r171]
  - [171, r27, r99]
  - [16, 101, r172]
  - [172, r28, r100]
  - [17, 102, r173]
  - [173, r29, r101]
  - [18, 103, r174]
  - [174, r30, r102]
  - [19, 104, r175]
  - [175, r31, r103]
  - [20, 105, r176]
  - [176, r32, r104]
  - [21, 106, r177]
  - [177, r33, r105]
  - [22, 107, r178]
  - [178, r34, r106]
  - [23, 96, r179]
  - [179, r35, r107]
  - [24, 109, r180]
  - [180, r36, r108]
  - [25, 110, r181]
  - [181, r37, r109]
  - [26, 111, r182]
  - [182, r38, r110]
  - [27, 112, r183]
  - [183, r39, r111]
  - [28, 113, r184]
  - [184, r40, r112]
  - [29, 114, r185]
  - [185, r41, r113]
  - [30, 115, r186]
  - [186, r42, r114]
  - [31, 116, r187]
  - [187, r43, r115]
  - [32, 117, r188]
  - [188, r44, r116]
  - [33, 118, r189]
  - [189, r45, r117]
  - [34, 119, r190]
  - [190, r46, r118]
  - [35, 108, r191]
  - [191, r47, r119]
  - [36, 121, r192]
  - [192, r48, r120]
  - [37, 122, r193]
  - [193, r49, r121]
  - [38, 123, r194]
  - [194, r50, r122]
  - [39, 124, r195]
  - [195, r51, r123]
  - [40, 125, r196]
  - [196, r52, r124]
  - [41, 126, r197]
  - [197, r53, r125]
  - [42, 127, r198]
  - [198, r54, r126]
  - [43, 128, r199]
  - [199, r55, r127]
  - [44, 129, r200]
  - [200, r56, r128]
  - [45, 130, r201]
  - [201, r57, r129]
  - [46, 131, r202]
  - [202, r58, r130]
  - [47, 120, r203]
  - [203, r59, r131]
  - [48, 133, r204]
  - [204, r60, r132]
  - [49, 134, r205]
  - [205, r61, r133]
  - [50, 135, r206]
  - [206, r62, r134]
  - [51, 136, r207]
  - [207, r63, r135]
  - [52, 137, r208]
  - [208, r64, r136]
  - [53, 138, r209]
  - [209, r65, r137]
  - [54, 139, r210]
  - [210, r66, r138]
  - [55, 140, r211]
  - [211, r67, r139]
  - [56, 141, r212]
  - [212, r68, r140]
  - [57, 142, r213]
  - [213, r69, r141]
  - [58, 143, r214]
  - [214, r70, r142]
  - [59, 132, r215]
  - [215, r71, r143]
  - [60, 145, r216]
  - [216, r72, r144]
  - [61, 146, r217]
  - [217, r73, r145]
  - [62, 147, r218]
  - [218, r74, r146]
  - [63, 148, r219]
  - [219, r75, r147]
  - [64, 149, r220]
  - [220, r76, r148]
  - [65, 150, r221]
  - [221, r77, r149]
  - [66, 151, r222]
  - [222, r78, r150]
  - [67, 152, r223]
  - [223, r79, r151]
  - [68, 153, r224]
  - [224, r80, r152]
  - [69, 154, r225]
  - [225, r81, r153]
  - [70, 155, r226]
  - [226, r82, r154]
  - [71, 144, r227]
  - [227, r83, r155]
macros:
  run: "g 200"
  induction_quick:
    - "print msg Running induction_quick (small mesh regression)."
    - "set tilt_modulus_in 2.0"
    - "set tilt_modulus_out 2.0"
    - "set tilt_rim_source_contact_h_in 1.0"
    - "set tilt_rim_source_contact_delta_epsilon_over_a_in 40.0"
    - "t0.006"
    - "g30"
    - "energy curvature"
